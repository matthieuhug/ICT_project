<!DOCTYPE html>
<html lang="fr">
    <header>
        <nav id="header-nav">
            <ul>
                <li><a href="index.html">Home</a></li> 
                <li><a href="5g.html">5G</a></li>
                <li><a href="sdr.html">SDR</a></li>
                <li><a href="project_examples.html">Project Examples</a></li>
                <li><a href="guided_implementation.html">Guided Implementation</a></li>
                <li><a href="qa_troubleshooting.html">Q&A / Troubleshooting</a></li>
                <li><a href="forum.html">Forum</a></li>
            </ul>
        </nav>
    </header>
    
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture du Réseau 5G</title>
    <link rel="stylesheet" href="styles.css">

    <!-- Style pour le code et bouton de copie -->
    <style>
        #instructions-container {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
        }

        .code-block-container {
            position: relative;
            background-color: #f4f4f4;
            padding: 10px;
            margin-top: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .code-block {
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 14px;
        }

        .copy-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
            padding: 3px 5px;
            background-color: #007bff;
            color: #fff;
            border: none;
            font-size: 12px;
        }

        .copy-btn:hover {
            background-color: #0056b3;
        }
    </style>

    <!-- Script JavaScript -->
    <script>
    window.addEventListener('DOMContentLoaded', (event) => {
        // Placeholder for fetch if you have header.html, or you can remove this section
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
            })
            .catch(error => {
                console.error('Erreur lors du chargement du header:', error);
            });
    });

    // Simulated instructions data
    const instructionsData = {
        "ue": {
            "smartphone": { text: "Instructions for configuring a smartphone.", code: "smartphone-config-code" },
            "pc": { text: `
                <h3>3 UE</h3>
                <p>The UE can be setup in multiple ways. We can use the OpenAirInterface UE using an SDR (USRP, BladeRF, LimSDR, ...) or we can use a phone with a re-programmable SIM card to align with the Core Network configuration and database.</p>
                <h4>3.1 OpenAirInterface UE with USRP</h4>
                <p>To build the UE, we use the same process that we used for the USRP using the buildoai tool, this time specifying we want the UE. For the test bench to work correctly, the UE should be running on a different machine. The commands to run to create the UE script are the following:</p>
                <div class="code-block-container">
                    <pre class="code-block">
cd ~/openairinterface5g
source oaienv
cd cmake_targets
./build_oai -w USRP --ninja --UE -C
                    </pre>
                    <button class="copy-btn" onclick="copyCode('cd ~/openairinterface5g\nsource oaienv\ncd cmake_targets\n./build_oai -w USRP --ninja --UE -C')">Copy</button>
                </div>
                <p>Now that the UE has been successfully built, we need to add its identity to the Core Network database for it to connect and access the network. We will use the built-in configuration parameters that come with the OpenAirInterface files.</p>
                <div class="code-block-container">
                    <pre class="code-block">
uicc0 = {
imsi = "208970100001127";
key = "fec86ba6eb707ed08905757b1bb44b8f";
opc = "c42449363bbad02b66d16bc975d77cc1";
dnn = "oai";
nssai_sst = 1;
nssai_sd = 66051;
}
                    </pre>
                    <button class="copy-btn" onclick="copyCode('uicc0 = {\nimsi = \"208970100001127\";\nkey = \"fec86ba6eb707ed08905757b1bb44b8f\";\nopc = \"c42449363bbad02b66d16bc975d77cc1\";\ndnn = \"oai\";\nnssai_sst = 1;\nnssai_sd = 66051;\n}')">Copy</button>
                </div>
                <p>In order to add this identity to the Core Network, we need to use the following command on our SQL database <code>oaidb2.sql</code>:</p>
                <div class="code-block-container">
                    <pre class="code-block">
INSERT INTO 'AuthenticationSubscription' 
('ueid', 'authenticationMethod', 'encPermanentKey', 'protectionParameterId', 'sequenceNumber', 'authenticationManagementField', 'algorithmId', 'encOpcKey', 'encTopcKey', 'vectorGenerationInHss', 'n5gcAuthMethod', 'rgAuthenticationInd', 'supi') 
VALUES 
('208970100001127', '5G_AKA', 'fec86ba6eb707ed08905757b1bb44b8f', 'fec86ba6eb707ed08905757b1bb44b8f', '{"sqn": "000000000020", "sqnScheme": "NON_TIME_BASED", "lastIndexes": {"ausf": 0}}', '8000', 'milenage', 'fec86ba6eb707ed08905757b1bb44b8f', NULL, NULL, NULL, NULL, '208970100001127');
                    </pre>
                    <button class="copy-btn" onclick="copyCode('INSERT INTO \'AuthenticationSubscription\'\n(\'ueid\', \'authenticationMethod\', \'encPermanentKey\', \'protectionParameterId\', \'sequenceNumber\', \'authenticationManagementField\', \'algorithmId\', \'encOpcKey\', \'encTopcKey\', \'vectorGenerationInHss\', \'n5gcAuthMethod\', \'rgAuthenticationInd\', \'supi\')\nVALUES\n(\'208970100001127\', \'5G_AKA\', \'fec86ba6eb707ed08905757b1bb44b8f\', \'fec86ba6eb707ed08905757b1bb44b8f\', \'{"sqn": "000000000020", "sqnScheme": "NON_TIME_BASED", "lastIndexes": {"ausf": 0}}\', \'8000\', \'milenage\', \'fec86ba6eb707ed08905757b1bb44b8f\', NULL, NULL, NULL, NULL, \'208970100001127\')')">Copy</button>
                </div>
                <p>Now we have two launch possibilities. The first one is to indicate to the UE launch script what parameters to use, or we can simply feed the information in the launch command like this:</p>
                <div class="code-block-container">
                    <pre class="code-block">
sudo ./nr-uesoftmodem -r 51 --numerology 1 --band 78 -C 3309480000 --sa --norkmod --ssb 238 -E --ue-fo-compensation --usrp-args "addr=192.168.10.2" --uicc0.imsi 001010000000001
                    </pre>
                    <button class="copy-btn" onclick="copyCode('sudo ./nr-uesoftmodem -r 51 --numerology 1 --band 78 -C 3309480000 --sa --norkmod --ssb 238 -E --ue-fo-compensation --usrp-args \"addr=192.168.10.2\" --uicc0.imsi 001010000000001')">Copy</button>
                </div>
            `, code: "" },
            "iot": { text: "Instructions for configuring NB-IoT.", code: "iot-config-code" },
        },
        "sdr": {
    "usrp": {
        text: `
            <h3>USRP</h3>
            <p>USRP devices are what we call SDRs (Software Defined Radios). An SDR is a wireless device that allows for a configurable RF front end with an FPGA (Field Programmable Gate Array) or a programmable system-on-chip (SoC) to perform digital functions.</p>
            
            <p>An FPGA is an integrated circuit that is referred to as 'field programmable' because it allows customers to reconfigure the hardware after manufacturing to meet specific use case requirements. This means we can choose things like the frequency we communicate on, the type of modulation we wish to use, the gain, the type of antennas, and much more.</p>
            
            <h4>UHD</h4>
            <p>The USRPs work using Ettus Research libraries called UHD (USRP Hardware Driver), which are installed on the host device to discover, run, and edit the USRP. Below is the installation process for the UHD libraries to run the equipment.</p>
            
            <p>It is possible to install UHD using Pybombs, but it has been found to be troublesome in certain builds. Manually building the libraries with <code>make</code> is the most efficient method.</p>
            
            <h4>Installation of UHD Libraries</h4>
            <p>Follow these steps to install UHD libraries:</p>
            
            <div class="code-block-container">
                <pre class="code-block">
sudo apt-get install autoconf automake build-essential ccache cmake cpufrequtils doxygen ethtool \
g++ git inetutils-tools libboost-all-dev libncurses5 libncurses5-dev libusb-1.0-0 libusb-1.0-0-dev \
libusb-dev python3-dev python3-mako python3-numpy python3-requests python3-scipy python3-setuptools \
python3-ruamel.yaml
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo apt-get install autoconf automake build-essential ccache cmake cpufrequtils doxygen ethtool \ng++ git inetutils-tools libboost-all-dev libncurses5 libncurses5-dev libusb-1.0-0 libusb-1.0-0-dev \nlibusb-dev python3-dev python3-mako python3-numpy python3-requests python3-scipy python3-setuptools \npython3-ruamel.yaml')">Copy</button>
            </div>
            
            <div class="code-block-container">
                <pre class="code-block">
git clone https://github.com/EttusResearch/uhd.git

cd <uhd-repo-path>/host
mkdir build
cd build
cmake ../

make
make test # This step is optional
sudo make install

sudo ldconfig
                </pre>
                <button class="copy-btn" onclick="copyCode('git clone https://github.com/EttusResearch/uhd.git\n\ncd <uhd-repo-path>/host\nmkdir build\ncd build\ncmake ../\n\nmake\nmake test # This step is optional\nsudo make install\n\nsudo ldconfig')">Copy</button>
            </div>
            
            <p>After completing these steps, the UHD libraries will be installed, and the USRP devices will be ready to use on your system.</p>
        `, 
        code: ""
    },
    "hackrf": { text: "Instructions for HackRF SDR.", code: "hackrf-sdr-code" },
    "limesdr": { text: "Instructions for LimeSDR SDR.", code: "limesdr-sdr-code" },
    "b210": {
        text: `
            <h3>USRP X310 Setup</h3>
            <p>The first step to use the USRP device, such as the X310, is to install the daughterboards that allow for the antenna connections. These daughterboards come as separate units and must be correctly placed on the main board after unscrewing the lid of the USRP X310.</p>
            
            <h4>USRP X310 Front Panel</h4>
            <p>The daughterboards and single plugged RF cables must be connected properly.</p>
            <img src="path_to_image_of_front_panel" alt="USRP X310 Front Panel">
            <p>Once the daughterboards are installed, ensure the full setup is as shown below:</p>
            <img src="path_to_image_of_full_setup" alt="Fully set daughterboards">
            
            <h4>Connecting USRP X310 to the Host</h4>
            <p>Now that the USRP is up and running, connect it to the host device using an ethernet cable. The X310 is connected through an ethernet cable with a conversion module from fiber to RJ45. After this, ensure your host device is in the correct network range (192.168.10.0/24) and proceed with the following:</p>
            
            <div class="code-block-container">
                <pre class="code-block">
ping 192.168.10.2
uhd_usrp_probe --args addr=192.168.10.2
                </pre>
                <button class="copy-btn" onclick="copyCode('ping 192.168.10.2\nuhd_usrp_probe --args addr=192.168.10.2')">Copy</button>
            </div>
            
            <h4>Updating Firmware</h4>
            <p>If necessary, update the firmware on the USRP to the latest ROM version:</p>
            <div class="code-block-container">
                <pre class="code-block">
uhd_image_loader --args="type=x300,addr=192.168.10.2,fpga=HG"
                </pre>
                <button class="copy-btn" onclick="copyCode('uhd_image_loader --args=\"type=x300,addr=192.168.10.2,fpga=HG\"')">Copy</button>
            </div>
            
            <h4>Ethernet Module</h4>
            <p>Ensure that the Ethernet module is connected correctly for proper communication:</p>
            <img src="path_to_image_of_ethernet_module" alt="USRP X310 Ethernet Module">
            
            <h4>Testing USRP X310 with GNU Radio</h4>
            <p>Once the hardware setup is complete, the USRP should be usable through GNU Radio or the OAI (OpenAirInterface) implementation for UE (User Equipment) or gNodeB.</p>
            <p>In case of issues with Rx and Tx, or code overflow in the OAI RAN implementation, you may need to run the following calibration commands:</p>
            
            <div class="code-block-container">
                <pre class="code-block">
uhd_cal_rx_iq_balance --args addr=192.168.40.3
uhd_cal_tx_iq_balance --args addr=192.168.40.3
uhd_cal_tx_dc_offset --args addr=192.168.40.3
                </pre>
                <button class="copy-btn" onclick="copyCode('uhd_cal_rx_iq_balance --args addr=192.168.40.3\nuhd_cal_tx_iq_balance --args addr=192.168.40.3\nuhd_cal_tx_dc_offset --args addr=192.168.40.3')">Copy</button>
            </div>
            
            <h4>Performance Tuning</h4>
            <p>If needed, you can adjust the Ethernet buffer settings for improved performance:</p>
            <div class="code-block-container">
                <pre class="code-block">
sudo ethtool -G eno2 tx 4096 rx 4096
sudo sysctl -w net.core.wmem_max=33554432
sudo sysctl -w net.core.rmem_max=33554432
sudo sysctl -w net.core.wmem_default=33554432
sudo sysctl -w net.core.rmem_default=33554432
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo ethtool -G eno2 tx 4096 rx 4096\nsudo sysctl -w net.core.wmem_max=33554432\nsudo sysctl -w net.core.rmem_max=33554432\nsudo sysctl -w net.core.wmem_default=33554432\nsudo sysctl -w net.core.rmem_default=33554432')">Copy</button>
            </div>
            
            <h4>Adding User Group</h4>
            <p>Ensure that the user is added to the necessary group for USRP device access:</p>
            <div class="code-block-container">
                <pre class="code-block">
sudo groupadd usrp
sudo usermod -aG usrp $USER
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo groupadd usrp\nsudo usermod -aG usrp $USER')">Copy</button>
            </div>
            
            <p>After completing these steps, the USRP X310 should be ready for use with the GNU Radio or OAI implementations.</p>
        `, 
        code: ""
    },
    "usrp_b210": {
        text: `
            <h3>USRP B210 Setup</h3>
            <p>The USRP B210 is much more straightforward compared to the USRP X310. It does not require daughterboard installation and is considered plug-and-play. The connection to the host is done through USB, and the power is also supplied through the USB cable.</p>
            <p>However, it is still necessary to discover the USRP through the UHD utilities. To do so, you can run the following commands:</p>
            
            <div class="code-block-container">
                <pre class="code-block">
sudo uhd_usrp_probe
sudo uhd_find_devices
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo uhd_usrp_probe\nsudo uhd_find_devices')">Copy</button>
            </div>
            
            <p>Once discovered, the USRP B210 is ready to be used with your SDR setup or GNU Radio.</p>
        `,
        code: ""
    },
},

        "ran": {
            "lte": { text: "Instructions for LTE RAN.", code: "lte-ran-code" },
            "5g": { text: `
                <h3>2 gNodeB</h3>
                <h4>2.1 Installing the gNodeB</h4>
                <p>For this installation section, we have chosen to use Ubuntu 20.04 as it is more suited for the OAI RAN build of this project. Ubuntu 22.04 and 24.04 lack certain dependencies that have yet to be upgraded to the latest Ubuntu versions.</p>
                <p>The first step of the installation process, just like the Core Network, is to clone the OpenAirInterface repository:</p>
                <div class="code-block-container">
                    <pre class="code-block">
git clone https://gitlab.eurecom.fr/oai/openairinterface5g.git ~/openairinterface5g
cd ~/openairinterface5g
git checkout develop
                    </pre>
                    <button class="copy-btn" onclick="copyCode('git clone https://gitlab.eurecom.fr/oai/openairinterface5g.git ~/openairinterface5g\ncd ~/openairinterface5g\ngit checkout develop')">Copy</button>
                </div>
                <p>The OpenAirInterface building process is fully automated and follows a list of parameters given to the buildoai script. Before building the gNodeB we need to install all the required dependencies, which can be done with the build file with the following flags:</p>
                <div class="code-block-container">
                    <pre class="code-block">
cd cmake_targets
sudo ./build_oai -I
                    </pre>
                    <button class="copy-btn" onclick="copyCode('cd cmake_targets\nsudo ./build_oai -I')">Copy</button>
                </div>
                <p>If this step is successful, we can build the gNodeB itself with the following parameters:</p>
                <div class="code-block-container">
                    <pre class="code-block">
cd ~/openairinterface5g
source oaienv
cd cmake_targets
./build_oai -w USRP --ninja --gNB -C
                    </pre>
                    <button class="copy-btn" onclick="copyCode('cd ~/openairinterface5g\nsource oaienv\ncd cmake_targets\n./build_oai -w USRP --ninja --gNB -C')">Copy</button>
                </div>
                <h4>2.2 Configuring the gNodeB</h4>
                <p>Now that it has been built, we need to configure our gNodeB so it can connect to the core network that is running on the actual host. To configure the gNodeB we need to match the existing parameters on the 5G CN. The configuration file that needs to be modified is located in <code>/openairinterface5g/ci-scripts/conf files</code> and the specific configuration file we need to modify depends on the USRP we are using. In this case, we are using a USRP B210.</p>
                <p>The settings that we will be modifying are the same we modified for the 5G CN, such as the PLMN, SST, SD (MCC, MNC, mnc length), and network slice list (SST, SD). These parameters need to be the same as the ones in the Core Network for the gNodeB to establish a correct connection.</p>
                <pre class="code-block">
Active_gNBs = ( "gNB-OAI");
Asn1_verbosity = "none";
gNBs =
(
{
gNB_ID = 0xe00;
gNB_name = "gNB-OAI";
tracking_area_code = 1;
plmn_list = ({
mcc = 001;
mnc = 01;
mnc_length = 2;
snssaiList = (
{
sst = 1;
sd = 0x010203;
},
{
sst = 1;
sd = 0x010203;
},
{
sst = 1;
sd = 0xffffff;
}
);
});
amf_ip_address = ( { ipv4 = "192.168.70.132"; ipv6 = "192:168:30::17"; active = "yes"; preference = "ipv4"; });
NETWORK_INTERFACES :
{
GNB_INTERFACE_NAME_FOR_NG_AMF = "demo-oai";
GNB_IPV4_ADDRESS_FOR_NG_AMF = "10.1.1.2";
GNB_INTERFACE_NAME_FOR_NGU = "demo-oai";
GNB_IPV4_ADDRESS_FOR_NGU = "10.1.1.2";
GNB_PORT_FOR_S1U = 2152;
};
}
);
                </pre>
                <button class="copy-btn" onclick="copyCode('Active_gNBs = ( \"gNB-OAI\");\nAsn1_verbosity = \"none\";\ngNBs =\n(\n{\ngNB_ID = 0xe00;\ngNB_name = \"gNB-OAI\";\ntracking_area_code = 1;\nplmn_list = ({\nmcc = 001;\nmnc = 01;\nmnc_length = 2;\nsnssaiList = (\n{\nst = 1;\nsd = 0x010203;\n},\n{\nst = 1;\nsd = 0x010203;\n},\n{\nst = 1;\nsd = 0xffffff;\n}\n);\n});\namf_ip_address = ( { ipv4 = \"192.168.70.132\"; ipv6 = \"192:168:30::17\"; active = \"yes\"; preference = \"ipv4\"; });\nNETWORK_INTERFACES :\n{\nGNB_INTERFACE_NAME_FOR_NG_AMF = \"demo-oai\";\nGNB_IPV4_ADDRESS_FOR_NG_AMF = \"10.1.1.2\";\nGNB_INTERFACE_NAME_FOR_NGU = \"demo-oai\";\nGNB_IPV4_ADDRESS_FOR_NGU = \"10.1.1.2\";\nGNB_PORT_FOR_S1U = 2152;\n};\n}\n);')">Copy</button>
                <h4>2.3 Launching the gNodeB</h4>
                <p>Once the gNodeB has been built and configured, it is simple to launch it using the built script. You can launch the gNodeB using the configuration file we just edited with the following command:</p>
                <div class="code-block-container">
                    <pre class="code-block">
sudo ./nr-softmodem -O ../../../targets/PROJECTS/GENERIC-NR-5GC/CONF/gnb.sa.band78.fr1.106PRB.usrpb210.conf --gNBs.[0].min_rxtxtime 6 --sa -E --continuous-tx
                    </pre>
                    <button class="copy-btn" onclick="copyCode('sudo ./nr-softmodem -O ../../../targets/PROJECTS/GENERIC-NR-5GC/CONF/gnb.sa.band78.fr1.106PRB.usrpb210.conf --gNBs.[0].min_rxtxtime 6 --sa -E --continuous-tx')">Copy</button>
                </div>
            `, code: "" },
        },
        "core": {
    "open5gs": { text: "Instructions for Open5GS Core.", code: "open5gs-core-code" },
    "amf": { 
        text: `
            <h3>1 The Core Network</h3>
            <p>This section explains in detail how the core network has been set up for this test bench. This allows us to make this process reproducible and allows tweaking for later work and updates to the system.</p>
            <p>First of all, two choices are possible regarding the Core Network. The first choice would be to set it up on the same machine as the gNodeB. This scenario is more accessible in case of lack of equipment but might create some instability on the system since the gNodeB is very demanding in terms of processing power. While using this first scenario, no routing will be necessary to propagate the packets coming from the gNodeB to the Core Network, thus making the whole setup more simple.</p>
            <p>In the second scenario, the Core Network is separated from the gNodeB on a secondary machine that will do all the processing for the Core Network. In this scenario, it will be necessary to set-up a simple routing command to guide the packets back and forth between the gNodeB and the Core Network.</p>
            <p>The Core Network used in this guide is OpenAirInterface’s product. Its latest version available is meant to be used on Ubuntu 20.04 LTS. The same version of Ubuntu that will be used throughout this guide as it is suited for the gNodeB as well.</p>
            
            <h4>1.1 System Tweaking</h4>
            <p>For this test bench to work at maximum efficiency, it is required to install low-latency kernels for the Linux OS. This kernel allows for a minimum of latency in the communication between the SDR and the processors. The installation of the low latency kernel is simple and achievable through the command line. Be aware that some components of the machine (trackpad, Wi-Fi, Bluetooth, ...) may not work on the low-latency kernel as it does not natively have the HWE support in the images.</p>
            <div class="code-block-container">
                <pre class="code-block">
sudo apt-get install linux-image-lowlatency
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo apt-get install linux-image-lowlatency')">Copy</button>
            </div>
            <p>After running this command, it is necessary to reboot the machine in order to select the new low-latency kernel from the boot menu. Be careful, as it will automatically boot on the old kernel if not told otherwise on boot.</p>
            <p>Now that we have the new kernel running, we need to set up the processors for them to run in full performance mode. Run the following commands:</p>
            <div class="code-block-container">
                <pre class="code-block">
# Checking CPU statistics
watch grep "cpu MHz" /proc/cpuinfo
                </pre>
                <button class="copy-btn" onclick="copyCode('watch grep \"cpu MHz\" /proc/cpuinfo')">Copy</button>
            </div>
            <div class="code-block-container">
                <pre class="code-block">
sudo apt-get install i7z
sudo i7z
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo apt-get install i7z\nsudo i7z')">Copy</button>
            </div>
            <div class="code-block-container">
                <pre class="code-block">
sudo apt-get install cpufrequtils
# Add the following line to the end of this file :
GOVERNOR="performance"
sudo nano /etc/default/cpufrequtils
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo apt-get install cpufrequtils\n# Add the following line to the end of this file :\nGOVERNOR=\"performance\"\nsudo nano /etc/default/cpufrequtils')">Copy</button>
            </div>
            <div class="code-block-container">
                <pre class="code-block">
sudo update-rc.d ondemand disable
echo performance | tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo update-rc.d ondemand disable\necho performance | tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor')">Copy</button>
            </div>
            <p>Now that our system is fully set for maximum performance and lowest kernel latency, we can start installing the actual Core Network of the 5G SA test bench.</p>

            <h4>1.2 Installing the Core Network</h4>
            <p>The core network that we use is from OpenAirInterface and is a fully functional 5G SA core network. It is built from the files located on their git repository:</p>
            <div class="code-block-container">
                <pre class="code-block">
git clone --branch v2.0.1 https://gitlab.eurecom.fr/oai/cn5g/oai-cn5g-fed.git
cd oai-cn5g-fed
git checkout -f v2.0.1
./scripts/syncComponents.sh
git submodule deinit --all --force
git submodule init
git submodule update
                </pre>
                <button class="copy-btn" onclick="copyCode('git clone --branch v2.0.1 https://gitlab.eurecom.fr/oai/cn5g/oai-cn5g-fed.git\ncd oai-cn5g-fed\ngit checkout -f v2.0.1\n./scripts/syncComponents.sh\ngit submodule deinit --all --force\ngit submodule init\ngit submodule update')">Copy</button>
            </div>
            <p>Now that we have pulled and built the Core Network, it is time to configure it to our needs. The main configuration required is to align the gNodeB and Core Network configuration. This means that they need to have the same PLMN (Public Land Mobile Network). The PLMN is broken down into multiple parameters:</p>
            <ul>
                <li>MCC (Mobile Country Code)</li>
                <li>MNC (Mobile Network Code)</li>
                <li>SERVED GUAMI MNC</li>
                <li>PLMN SUPPORT MNC</li>
                <li>PLMN SUPPORT TAC</li>
            </ul>
            <p>These parameters are set in the <code>docker-compose-basic-nrf.yaml</code> file that guides the Docker images when launched. You will need to edit this file using nano, vim, or VSCode for better visibility. These parameters depend on your location and choice, but they must be aligned with the gNodeB settings.</p>
            <div class="code-block-container">
                <pre class="code-block">
oai-amf:
  container_name: "oai-amf"
  image: oaisoftwarealliance/oai-amf:v2.0.1
  expose:
    - 80/tcp
    - 8080/tcp
    - 38412/sctp
  volumes:
    - ./conf/basic_nrf_config.yaml:/openair-amf/etc/config.yaml
  environment:
    - TZ=Europe/Paris
    - MCC=208
    - MNC=36
    - REGION_ID=31
    - AMF_SET_ID=1
    - SERVED_GUAMI_MCC_0=208
    - SERVED_GUAMI_MNC_0=36
    - SERVED_GUAMI_REGION_ID_0=31
    - SERVED_GUAMI_AMF_SET_ID_0=1
    - PLMN_SUPPORT_MCC=208
    - PLMN_SUPPORT_MNC=36
    - PLMN_SUPPORT_TAC=1
    - SST_0=1
    - SST_1=1
    - SD_1=1
                </pre>
                <button class="copy-btn" onclick="copyCode('oai-amf:\n  container_name: \"oai-amf\"\n  image: oaisoftwarealliance/oai-amf:v2.0.1\n  expose:\n    - 80/tcp\n    - 8080/tcp\n    - 38412/sctp\n  volumes:\n    - ./conf/basic_nrf_config.yaml:/openair-amf/etc/config.yaml\n  environment:\n    - TZ=Europe/Paris\n    - MCC=208\n    - MNC=36\n    - REGION_ID=31\n    - AMF_SET_ID=1\n    - SERVED_GUAMI_MCC_0=208\n    - SERVED_GUAMI_MNC_0=36\n    - SERVED_GUAMI_REGION_ID_0=31\n    - SERVED_GUAMI_AMF_SET_ID_0=1\n    - PLMN_SUPPORT_MCC=208\n    - PLMN_SUPPORT_MNC=36\n    - PLMN_SUPPORT_TAC=1\n    - SST_0=1\n    - SST_1=1\n    - SD_1=1')">Copy</button>
            </div>

            <h4>1.3 Launching the Core Network</h4>
            <p>Before launching the Core Network, you may need to update the native Docker installation. Upgrade the version from the basic PPA of Ubuntu:</p>
            <div class="code-block-container">
                <pre class="code-block">
cd /usr/local/bin && sudo rm -rf docker-compose
sudo curl -SL https://github.com/docker/compose/releases/download/v2.1.1/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose
sudo chmod +x docker-compose
                </pre>
                <button class="copy-btn" onclick="copyCode('cd /usr/local/bin && sudo rm -rf docker-compose\nsudo curl -SL https://github.com/docker/compose/releases/download/v2.1.1/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose\nsudo chmod +x docker-compose')">Copy</button>
            </div>
            <p>Set up your nameservers to use Google DNS instead of the enterprise DNS for internet connectivity:</p>
            <div class="code-block-container">
                <pre class="code-block">
# Add the following lines at the end of /etc/resolv.conf :
nameserver 8.8.8.8
nameserver 8.8.4.4
                </pre>
                <button class="copy-btn" onclick="copyCode('# Add the following lines at the end of /etc/resolv.conf :\nnameserver 8.8.8.8\nnameserver 8.8.4.4')">Copy</button>
            </div>
            <p>Now reload the configuration:</p>
            <div class="code-block-container">
                <pre class="code-block">
sudo systemctl daemon-reload
sudo systemctl restart docker
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo systemctl daemon-reload\nsudo systemctl restart docker')">Copy</button>
            </div>
            <p>Once everything is set up, you can launch the Core Network with the following command:</p>
            <div class="code-block-container">
                <pre class="code-block">
sudo python3 core-network.py --type start-basic
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo python3 core-network.py --type start-basic')">Copy</button>
            </div>

            <p>To stop the Core Network, use:</p>
            <div class="code-block-container">
                <pre class="code-block">
sudo python3 core-network.py --type stop-basic
                </pre>
                <button class="copy-btn" onclick="copyCode('sudo python3 core-network.py --type stop-basic')">Copy</button>
            </div>

            <p>Now the Core Network is up and running, and we can proceed with the installation of the gNodeB.</p>
        `, 
        code: "" 
    },
},

        "os": {
            "ubuntu": { text: "Instructions for Ubuntu OS.", code: "ubuntu-os-code" },
            "centos": { text: "Instructions for CentOS OS.", code: "centos-os-code" },
        }
    };

    // Fonction pour afficher les instructions en fonction de la sélection
    function loadInstructions(selectId) {
        const selectedValue = document.getElementById(selectId).value;
        const instructionsElem = document.getElementById(selectId + '-instructions');

        if (selectedValue) {
            const instruction = instructionsData[selectId][selectedValue];

            let htmlContent = `<p>${instruction.text}</p>`;
            
            // Section de code avec bouton de copie
            if (instruction.code) {
                htmlContent += `
                    <div class="code-block-container">
                        <pre class="code-block">${instruction.code}</pre>
                        <button class="copy-btn" onclick="copyCode('${instruction.code}')">Copy</button>
                    </div>
                `;
            }

            instructionsElem.innerHTML = htmlContent;
        } else {
            instructionsElem.innerHTML = "Please make a selection to see specific instructions.";
        }
    }

    // Fonction pour copier le code
    function copyCode(code) {
        navigator.clipboard.writeText(code).then(() => {
            alert("Code copied to clipboard!");
        }).catch(err => {
            console.error("Failed to copy code: ", err);
        });
    }
</script>

</head>
<body>
    <!-- Conteneur pour le header -->
    <div id="header-container"></div>

    <div id="custom-configurator">
        <h2>Custom Configuration</h2>
        
        <!-- Dropdown Menus -->
        <label for="ue">Select a UE:</label>
        <select id="ue" onchange="loadInstructions('ue')">
            <option value="">--Select--</option>
            <option value="smartphone">Smartphone</option>
            <option value="pc">PC</option>
            <option value="iot">nb-iot</option>
        </select>
    
        <label for="sdr">Select an SDR:</label>
        <select id="sdr" onchange="loadInstructions('sdr')">
            <option value="">--Select--</option>
            <option value="hackrf">HackRF</option>
            <option value="limesdr">LimeSDR</option>
            <option value="b210">B210</option>
        </select>
    
        <label for="ran">Select the logical RAN:</label>
        <select id="ran" onchange="loadInstructions('ran')">
            <option value="">--Select--</option>
            <option value="lte">LTE</option>
            <option value="5g">5G</option>
        </select>
    
        <label for="core">Select the core network:</label>
        <select id="core" onchange="loadInstructions('core')">
            <option value="">--Select--</option>
            <option value="open5gs">Open5GS</option>
            <option value="amf">AMF-based</option>
        </select>
    
        <label for="os">Choose OS:</label>
        <select id="os" onchange="loadInstructions('os')">
            <option value="">--Select--</option>
            <option value="ubuntu">Ubuntu</option>
            <option value="centos">CentOS</option>
        </select>
        
        <!-- Containers for each category's instructions -->
        <div id="instructions-container">
            <h3>Instructions</h3>
            
            <!-- UE Instructions -->
            <h4>Instructions for the UE</h4>
            <div id="ue-instructions">Please make a selection for UE to see specific instructions.</div>
            
            <!-- SDR Instructions -->
            <h4>Instructions for the SDR</h4>
            <div id="sdr-instructions">Please make a selection for SDR to see specific instructions.</div>
            
            <!-- RAN Instructions -->
            <h4>Instructions for the RAN</h4>
            <div id="ran-instructions">Please make a selection for RAN to see specific instructions.</div>
            
            <!-- Core Network Instructions -->
            <h4>Instructions for the Core Network</h4>
            <div id="core-instructions">Please make a selection for Core Network to see specific instructions.</div>
            
            <!-- OS Instructions -->
            <h4>Instructions for the OS</h4>
            <div id="os-instructions">Please make a selection for OS to see specific instructions.</div>
        </div>
    </div>
</body>
</html>
